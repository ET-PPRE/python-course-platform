{# templates/account/password_change.html #}
{% extends "base.html" %}
{% load i18n widget_tweaks allauth %}

{% block head_title %}{% trans "Change Password" %}{% endblock head_title %}

{% block base_content %}
<div class="page-container py-10">
  <div class="max-w-md mx-auto bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-700 rounded-xl shadow-lg p-6 sm:p-8">

    <!-- Title -->
    <h1 class="page-title text-center text-2xl sm:text-3xl mb-2">
      {% trans "Change Password" %}
    </h1>
    <p class="text-sm text-center text-zinc-600 dark:text-zinc-300 mb-6">
      {% trans "Enter your current password and your new password." %}
    </p>

    {% if form.errors or form.non_field_errors %}
      <div class="mb-4 rounded-md border border-red-300/60 bg-red-50 p-3 text-sm text-red-800
                  dark:border-red-800/60 dark:bg-red-900/20 dark:text-red-200">
        {% trans "Please fix the errors below." %}
      </div>
    {% endif %}

    <form method="post" action="{% url 'account_change_password' %}" class="space-y-5">
      {% csrf_token %}
      {{ redirect_field }}

      <!-- Current password -->
      <div>
        <label for="{{ form.oldpassword.id_for_label }}" class="block text-sm font-medium text-zinc-700 dark:text-zinc-200 mb-1">
          {% trans "Current Password" %}
        </label>
        {% render_field form.oldpassword class+="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500 text-sm" %}
        {% if form.oldpassword.errors %}
          <p class="mt-1 text-xs text-red-600 dark:text-red-400">{{ form.oldpassword.errors|join:", " }}</p>
        {% endif %}
      </div>

      <!-- New password -->
      <div>
        <label for="{{ form.password1.id_for_label }}" class="block text-sm font-medium text-zinc-700 dark:text-zinc-200 mb-1">
          {% trans "New Password" %}
        </label>
        {% render_field form.password1 class+="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500 text-sm" %}
        {% if form.password1.errors %}
          <p class="mt-1 text-xs text-red-600 dark:text-red-400">{{ form.password1.errors|join:", " }}</p>
        {% endif %}
      </div>

      <!-- Confirm -->
      <div>
        <label for="{{ form.password2.id_for_label }}" class="block text-sm font-medium text-zinc-700 dark:text-zinc-200 mb-1">
          {% trans "Confirm New Password" %}
        </label>
        {% render_field form.password2 class+="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500 text-sm" %}
        {% if form.password2.errors %}
          <p class="mt-1 text-xs text-red-600 dark:text-red-400">{{ form.password2.errors|join:", " }}</p>
        {% endif %}
      </div>

      <!-- Actions -->
      <button type="submit" class="btn btn-primary w-full">
        {% trans "Change Password" %}
      </button>
      <p class="text-center text-sm mt-2">
        <a href="{% url 'account_reset_password' %}" class="link">
          {% trans "Forgot your password?" %}
        </a>
      </p>
    </form>
  </div>
</div>
{% endblock base_content %}
